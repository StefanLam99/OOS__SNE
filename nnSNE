from time import time
import numpy as np
from tensorflow import keras
from utils import blockPrint, enablePrint
from tSNE import cond_probs, joint_average_P, joint_Q, pca
from autoencoder import *
from datasets import Dataset
from  neural_tSNE import *
layer_dim = [784,500,500,2000, 2]
seed = 0
dataset = Dataset(seed)
X, y , X_train, y_train, X_test, y_test = dataset.get_MNIST_data(n_train=500)
RBM = Autoencoder(layer_dim)
RBM.pretrain(X_train.T, epochs=15)
RBM.save('Models/test')
autoencoder, encoder, decoder = RBM.unroll()
encoder.summary()
model = neural_tSNE()
model.load_model(encoder)
model.train(X_train)
model.save('Models/testENCODER')









